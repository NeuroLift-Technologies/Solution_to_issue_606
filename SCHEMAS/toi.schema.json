{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Terms of Interaction",
  "type": "object",
  "required": ["toiVersion", "agent", "interactionContract"],
  "properties": {
    "toiVersion": {
      "type": "string",
      "pattern": "^v\\d+\\.\\d+"
    },
    "agent": {
      "type": "object",
      "required": ["identity", "capabilities", "constraints", "initiationRights"],
      "properties": {
        "identity": {
          "type": "object",
          "required": ["role", "description"],
          "properties": {
            "role": { "type": "string", "minLength": 1 },
            "description": { "type": "string", "minLength": 1 }
          }
        },
        "capabilities": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1
        },
        "constraints": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1
        },
        "initiationRights": {
          "type": "object",
          "required": [
            "canInitiateWithoutPrompt",
            "maxInitiationsPerSession",
            "escalationPaths",
            "conditions"
          ],
          "properties": {
            "canInitiateWithoutPrompt": { "type": "boolean" },
            "maxInitiationsPerSession": { "type": "integer", "minimum": 0 },
            "escalationPaths": {
              "type": "array",
              "items": { "type": "string" }
            },
            "conditions": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        }
      }
    },
    "interactionContract": {
      "type": "object",
      "required": ["accessibility", "memoryManagement"],
      "properties": {
        "accessibility": {
          "type": "object",
          "required": [
            "readingLevel",
            "maxTokensPerTurn",
            "formattingPreferences",
            "neurodivergentConsiderations"
          ],
          "properties": {
            "readingLevel": {
              "type": "string",
              "enum": ["elementary", "middle", "high_school", "college"]
            },
            "maxTokensPerTurn": { "type": "integer", "minimum": 32 },
            "formattingPreferences": {
              "type": "array",
              "items": { "type": "string" }
            },
            "neurodivergentConsiderations": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "memoryManagement": {
          "type": "object",
          "required": ["scope", "persistence", "accessControl"],
          "properties": {
            "scope": {
              "type": "string",
              "enum": ["session", "participant", "global"]
            },
            "persistence": {
              "type": "string",
              "enum": ["ephemeral", "durable"]
            },
            "accessControl": {
              "type": "array",
              "items": { "type": "string" },
              "minItems": 1
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "required": ["createdBy", "createdAt"],
      "properties": {
        "createdBy": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "tags": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    }
  },
  "additionalProperties": false
}
